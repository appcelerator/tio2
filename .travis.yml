language: objective-c

before_install:

install:

 - # Need to install jq to process the JSON
 - brew install jq # process JSON 

 - sudo npm install -g titanium
 - titanium login travisci@appcelerator.com travisci
 - titanium sdk install latest --no-progress-bars

 - export TITANIUM_ROOT=`ti sdk list -o json | jq -r '.defaultInstallLocation'`
 - mkdir -p "$TITANIUM_ROOT/sdks/"

 - cd "$TITANIUM_ROOT/sdks/"
 - wget http://dl.google.com/android/android-sdk_r23.0.2-macosx.zip
 - unzip -qq -o android-sdk_r23.0.2-macosx.zip
 - ANDROID_HOME=${PWD}/android-sdk-macosx
 - titanium config android.sdkPath $ANDROID_HOME

 - export ANDROID_HOME
 - export PATH=${PATH}:${ANDROID_HOME}/tools:${ANDROID_HOME}/platform-tools
  
 - echo "Installing and configuring Android SDK + Tools"

 - # Install required Android components.
 - echo yes | android -s update sdk --no-ui --all --filter tools
 - echo yes | android -s update sdk --no-ui --all --filter platform-tools
 - echo yes | android -s update sdk --no-ui --all --filter extra-android-support 
 - echo yes | android -s update sdk --no-ui --all --filter android-19
 - echo yes | android -s update sdk --no-ui --all --filter addon-google_apis-google-19
 - echo yes | android -s update sdk --no-ui --all --filter sys-img-armeabi-v7a-android-19
 - android list targets
 - echo no | android create avd --force -n test -t android-19 --abi google_apis/armeabi-v7a
 
 - emulator -avd test -no-skin -no-audio -no-window &
 - android-wait-for-emulator
 - adb shell input keyevent 82 &

 - npm install

script:

 - ./bin/tio2 ./example --platform ios
 - ./bin/tio2 ./example --platform android

after_success:
